<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Way-To-MPKC From UOV - As it was</title><meta name="Description" content="Keep Crazy"><meta property="og:title" content="Way-To-MPKC From UOV">
<meta property="og:description" content="Keep Crazy">
<meta property="og:type" content="article">
<meta property="og:url" content="https://galoishlee.github.io/uov/"><meta property="og:image" content="https://galoishlee.github.io/images/Apple-Devices-Preview.png"><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Way-To-MPKC From UOV">
<meta name="twitter:description" content="Keep Crazy"><meta name="twitter:image" content="https://galoishlee.github.io/images/Apple-Devices-Preview.png"><meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://galoishlee.github.io/uov/" /><link rel="prev" href="https://galoishlee.github.io/badagent0x00-intro/" /><link rel="next" href="https://galoishlee.github.io/vectorspace-matters/" /><link rel="stylesheet" href="/css/style.min.3f4dd71b0e7fc12a84f3214cf872ccb63aa272f06dc4fa3ffd906ddcfac004db.css" integrity="sha256-P03XGw5/wSqE8yFM+HLMtjqicvBtxPo//ZBt3PrABNs="><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Way-To-MPKC From UOV",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/galoishlee.github.io\/uov\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/galoishlee.github.io\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","wordcount":  3374 ,
        "url": "https:\/\/galoishlee.github.io\/uov\/","datePublished": "2024-11-13T19:39:56+08:00","dateModified": "2024-11-13T19:39:56+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/s2.loli.net\/2024\/03\/15\/3hzW1UX5dHkIKuL.png"},"author": {
                "@type": "Person",
                "name": "Halois"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="As it was"><span class="header-title-pre"><i class='fas fa-bacon' aria-hidden='true'></i></span>Think thickly</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/categories/documentation/"> 文档 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="/friends/" title="Freinds"> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="选择语言">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/uov/" selected>简体中文</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="As it was"><span class="header-title-pre"><i class='fas fa-bacon' aria-hidden='true'></i></span>Think thickly</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/categories/documentation/" title="">文档</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="/friends/" title="Freinds">友链</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/uov/" selected>简体中文</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Way-To-MPKC From UOV</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Halois</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-11-13">2024-11-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 3374 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 7 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#uov">UOV</a>
      <ul>
        <li><a href="#notation">Notation</a></li>
        <li><a href="#的特殊结构"> 的特殊结构</a></li>
        <li><a href="#签名者的目标">签名者的目标</a></li>
        <li><a href="#关键操作">关键操作</a></li>
        <li><a href="#推导与重组">推导与重组</a></li>
        <li><a href="#线性系统显现">线性系统显现</a></li>
        <li><a href="#最终的--线性系统">最终的  线性系统</a></li>
        <li><a href="#验证过程纯粹的代入求值">验证过程：纯粹的“代入求值”</a></li>
        <li><a href="#总结">总结</a></li>
      </ul>
    </li>
    <li><a href="#矩阵视角">矩阵视角</a>
      <ul>
        <li><a href="#二次型的一般矩阵表示">二次型的一般矩阵表示</a></li>
        <li><a href="#签名者的视角-的矩阵结构">签名者的视角： 的矩阵结构</a></li>
        <li><a href="#签名者的线性系统变换演示">签名者的线性系统变换演示</a></li>
        <li><a href="#攻击者的失败变换演示">攻击者的（失败）变换演示</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="uov">UOV</h2>
<h3 id="notation">Notation</h3>
<p>本文将使用以下变量：</p>
<ul>
<li><strong>\(m\) 个“油”变量 (Oil):</strong> \(o_1, o_2, \dots, o_m\)</li>
<li><strong>\(v\) 个“醋”变量 (Vinegar):</strong> \(v_1, v_2, \dots, v_v\) (其中 \(v = n-m\))</li>
<li><strong>\(m\) 个方程</strong> \(F_1, \dots, F_m\)</li>
<li><strong>\(m\) 个目标哈希值</strong> \(z_1, \dots, z_m\)</li>
</ul>
<p>我们要处理的系统是 \(F(x) = z\)，即 \(F_k(o, v) = z_k\)，对 \(k = 1, \dots, m\) 成立。</p>
<hr>
<h3 id="的特殊结构">\(F\) 的特殊结构</h3>
<p>UOV的核心秘密在于 \(F\) 的特殊构造：<strong>\(F\) 的方程中可以有任意的“醋-醋”项 (\(v_i v_j\)) 和“油-醋”项 (\(o_i v_j\))，但绝对没有“油-油”项 (\(o_i o_j\))。</strong></p>
<p>因此，我们的 \(m\) 个方程中，第 \(k\) 个方程 \(F_k\) 的<strong>最一般形式</strong>可以写成：
</p>
$$
F_k(o, v) = \underbrace{\sum_{i=1}^{v} \sum_{j=i}^{v} \alpha_{k,i,j} v_i v_j}_{\text{醋-醋 (二次)}} + \underbrace{\sum_{i=1}^{m} \sum_{j=1}^{v} \beta_{k,i,j} o_i v_j}_{\text{油-醋 (混合)}} + \underbrace{\sum_{i=1}^{m} \gamma_{k,i} o_i + \sum_{j=1}^{v} \delta_{k,j} v_j + C_k}_{\text{所有线性项和常数项}}
$$<ul>
<li>\(\alpha, \beta, \gamma, \delta, C\) 都是私钥中已知的常数系数。</li>
<li>注意看，这个方程对于 \(v\) 变量是<strong>二次</strong>的，但对于 \(o\) 变量是<strong>线性</strong>的（\(o_i\) 只以 1 次方出现）。</li>
</ul>
<h3 id="签名者的目标">签名者的目标</h3>
<p>签名者的目标是找到一组 \((o, v)\) 使得 \(F_k(o, v) = z_k\) 对所有的 \(k=1, \dots, m\) 成立。</p>
<p>完整的方程组（共 \(m\) 个）看起来是这样的：
</p>
$$
\begin{cases}    F_1(o, v) = z_1 \\\\    F_2(o, v) = z_2 \\\\    \quad \vdots \\\\    F_m(o, v) = z_m \end{cases}
$$<h3 id="关键操作">关键操作</h3>
<p>签名者执行以下操作：</p>
<ol>
<li><strong>随机选择“醋”：</strong> 签名者为所有 \(v\) 个“醋”变量 \(v_1, \dots, v_v\) 随机挑选一组具体的值，我们称之为 \(\bar{v}_1, \dots, \bar{v}_v\)。</li>
<li><strong>代入方程：</strong> 将这些已知的 \(\bar{v}\) 值代入到第 1 步的 \(F_k\) 方程中。</li>
</ol>
<p>我们来看代入后，第 \(k\) 个方程 \(F_k(o, \bar{v}) = z_k\) 变成了什么：</p>
$$
z_k = \sum_{i=1}^{v} \sum_{j=i}^{v} \alpha_{k,i,j} \bar{v}_i \bar{v}_j + \sum_{i=1}^{m} \sum_{j=1}^{v} \beta_{k,i,j} o_i \bar{v}_j + \sum_{i=1}^{m} \gamma_{k,i} o_i + \sum_{j=1}^{v} \delta_{k,j} \bar{v}_j + C_k
$$<h3 id="推导与重组">推导与重组</h3>
<p>现在，方程中唯一的未知数只剩下 \(m\) 个“油”变量 \(o_1, \dots, o_m\)。</p>
<p>我们把上式中所有包含 \(o_i\) 的项（未知项）移到左边，所有纯常数项（已知项）移到右边。</p>
<p><strong>1. 找出所有未知项（包含 \(o_i\) 的项）：</strong></p>
$$
\sum_{i=1}^{m} \sum_{j=1}^{v} \beta_{k,i,j} o_i \bar{v}_j + \sum_{i=1}^{m} \gamma_{k,i} o_i
$$<p>我们可以按 \(o_i\) 合并同类项：</p>
$$
= \sum_{i=1}^{m} o_i \cdot \left( \sum_{j=1}^{v} \beta_{k,i,j} \bar{v}_j + \gamma_{k,i} \right)
$$<p><strong>2. 找出所有已知项（纯常数项）：</strong></p>
$$
\sum_{i=1}^{v} \sum_{j=i}^{v} \alpha_{k,i,j} \bar{v}_i \bar{v}_j + \sum_{j=1}^{v} \delta_{k,j} \bar{v}_j + C_k
$$<p><strong>3. 重组第 \(k\) 个方程：</strong></p>
$$
\sum_{i=1}^{m} o_i \cdot \underbrace{\left( \sum_{j=1}^{v} \beta_{k,i,j} \bar{v}_j + \gamma_{k,i} \right)}_{\text{这是 \(o_i\) 的系数, 记为 } A_{k,i}} = z_k - \underbrace{\left( \sum_{i=1}^{v} \sum_{j=i}^{v} \alpha_{k,i,j} \bar{v}_i \bar{v}_j + \sum_{j=1}^{v} \delta_{k,j} \bar{v}_j + C_k \right)}_{\text{这是一个大常数, 记为 } B_k}
$$<h3 id="线性系统显现">线性系统显现</h3>
<p>因为所有的 \(\bar{v}_j\) 都是已知值，所以 \(A_{k,i}\) 和 \(B_k\) 都是可以计算出来的具体常数。</p>
<p>我们再定义一个常数 \(R_k = z_k - B_k\)。</p>
<p>现在，第 \(k\) 个方程被<strong>严格地</strong>简化为：</p>
$$
A_{k,1} o_1 + A_{k,2} o_2 + \dots + A_{k,m} o_m = R_k
$$<p>这，就是一个关于 \(o_1, \dots, o_m\) 的<strong>一元线性方程</strong>。</p>
<h3 id="最终的--线性系统">最终的 \(m \times m\) 线性系统</h3>
<p>我们有 \(m\) 个这样的方程（\(k=1\) 到 \(m\)），把它们全部写在一起，就得到了一个 \(m\) 个方程、 \(m\) 个未知数（\(o_1, \dots, o_m\)）的标准线性方程组：</p>
$$
\begin{cases}    A_{1,1}o_1 + A_{1,2}o_2 + \dots + A_{1,m}o_m = R_1 \\\\    A_{2,1}o_1 + A_{2,2}o_2 + \dots + A_{2,m}o_m = R_2 \\\\    \quad \vdots \\\\    A_{m,1}o_1 + A_{m,2}o_2 + \dots + A_{m,m}o_m = R_m \end{cases}
$$<p><strong>这就是推导的最终结果。</strong> 签名者通过高斯消元法等标准方法解这个 \(m \times m\) 线性系统，得到“油”变量 \(\bar{o}_1, \dots, \bar{o}_m\) 的值。</p>
<p>(如果这个 \(m \times m\) 系统恰好无解，签名者只需回到第 3 步，重新随机选择一组 \(\bar{v}\) 值，再试一次即可。)</p>
<h3 id="验证过程纯粹的代入求值">验证过程：纯粹的“代入求值”</h3>
<p>我们来梳理一下验证者（Verifier）的工作：</p>
<p><strong>验证者拥有：</strong></p>
<ol>
<li><strong>公钥 \(G\)：</strong> 那组 \(m\) 个公开的、看起来非常复杂的二次方程。</li>
<li><strong>消息 \(\mu\)：</strong> 原始消息。</li>
<li><strong>签名 \(y\)：</strong> 签名者提供的 \(n\) 个值的向量， \(y = (y_1, y_2, \dots, y_n)\)。</li>
</ol>
<p><strong>验证步骤：</strong></p>
<ol>
<li>
<p>计算目标哈希值：</p>
<p>验证者计算 \(z = H(\mu)\)。 ( \(z\) 是一个 \(m\) 个值的向量)</p>
</li>
<li>
<p>核心步骤：计算签名结果 \(z'\)</p>
<p>验证者将收到的签名 \(y\)（这 \(n\) 个数值）代入到公钥 \(G\) 的 \(m\) 个方程中，计算出结果 \(z'\)。</p>
$$
   z' = G(y)
   $$<p>展开来说，就是：</p>
$$
   \begin{cases}    z'_1 = G_1(y_1, y_2, \dots, y_n) \\\\    z'_2 = G_2(y_1, y_2, \dots, y_n) \\\\   \quad \vdots \\\\    z'_m = G_m(y_1, y_2, \dots, y_n) \end{cases}
   $$<p>这里<strong>没有任何“求解”</strong>。\(G\) 是已知的方程，\(y\) 是已知的数值。这只是一个纯粹的<strong>算术计算</strong>。</p>
</li>
<li>
<p>比对：</p>
<p>验证者检查 \(z'\) 是否等于 \(z\)。</p>
<ul>
<li>如果 \(z' = z\)，签名有效。</li>
<li>如果 \(z' \neq z\)，签名无效。</li>
</ul>
</li>
</ol>
<table>
  <thead>
      <tr>
          <th><strong>特征 (Feature)</strong></th>
          <th><strong>签名过程 (Signing Process)</strong></th>
          <th><strong>验证过程 (Verification Process)</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>目标 (Goal)</strong></td>
          <td><strong>求解</strong> \(y\) 使得 \(G(y)=z\)</td>
          <td><strong>检查</strong> \(G(y)\) 是否等于 \(z\)</td>
      </tr>
      <tr>
          <td><strong>所用密钥 (Key Used)</strong></td>
          <td><strong>私钥</strong> (\(F\) 和 \(A\))</td>
          <td><strong>公钥</strong> (\(G\))</td>
      </tr>
      <tr>
          <td><strong>核心操作 (Core Op)</strong></td>
          <td><strong>解方程 (Solve Equations)</strong></td>
          <td><strong>函数求值 (Evaluate Function)</strong></td>
      </tr>
      <tr>
          <td><strong>&ldquo;线性系统&quot;在何处</strong></td>
          <td><strong>有 (Exists)</strong>：通过固定“醋”变量，将 \(F(x)=z\) 转化为 \(m \times m\) 线性系统来<strong>求解</strong>“油”变量。</td>
          <td><strong>无 (Does not exist)</strong>：只是将 \(y\) 代入 \(G\) 中进行二次<strong>计算</strong>。</td>
      </tr>
      <tr>
          <td><strong>\(A\) 的作用</strong></td>
          <td>用 \(A^{-1}\) 将解 \(x\) <strong>变换</strong>为签名 \(y\) (\(y = A^{-1}(x)\))。</td>
          <td><strong>不使用</strong> \(A\) 或 \(A^{-1}\)。</td>
      </tr>
  </tbody>
</table>
<h3 id="总结">总结</h3>
<ul>
<li><strong>签名</strong>的“魔法”在于利用秘密 \(F\) 和 \(A\) 将一个（对他人而言）困难的二次问题<strong>转化</strong>为一个（对自己而言）简单的<strong>线性问题</strong>来<strong>求解</strong>。</li>
<li><strong>验证</strong>的“朴实”在于它不进行任何变换，它只是<strong>代入</strong>签名 \(y\) 到公钥 \(G\) 中，看结果是否匹配。</li>
</ul>
<p>这正是UOV方案（以及所有公钥密码）安全性的基础：正向计算 \(G(y)\) 很容易，但反向求解 \(y\)（即签名）在没有私钥“后门”的情况下极其困难。</p>
<h2 id="矩阵视角">矩阵视角</h2>
<h3 id="二次型的一般矩阵表示">二次型的一般矩阵表示</h3>
<p>任何一个 \(n\) 元二次方程 \(f(x) = z\) 都可以被写成矩阵形式：</p>
$$f(x) = x^T P x + L^T x + C = z$$<ul>
<li>\(x\) 是 \(n \times 1\) 的变量向量。</li>
<li>\(P\) 是一个 \(n \times n\) 的对称矩阵，代表所有二次项（如 \(x_i x_j\)）。</li>
<li>\(L\) 是一个 \(n \times 1\) 的向量，代表所有线性项（如 \(x_i\)）。</li>
<li>\(C\) 是一个常数。</li>
</ul>
<hr>
<h3 id="签名者的视角-的矩阵结构">签名者的视角：\(F\) 的矩阵结构</h3>
<p>签名者使用<strong>私有变量</strong> \(x\)，它被<strong>结构化</strong>地分为“油” \(o\) ( \(m \times 1\) 向量) 和“醋” \(v\) ( \(v \times 1\) 向量)：</p>
$$x = \begin{bmatrix} o \\\\ v \end{bmatrix}$$<p>私钥 \(F\) 的 \(m\) 个方程中的第 \(k\) 个 \(F_k(x) = z_k\) 具有 <strong>“无油-油”</strong> 的特殊结构。</p>
<p>这意味着 \(F_k\) 的二次型矩阵 \(P_k\)（一个 \(n \times n\) 矩阵）在 \(x = \begin{bmatrix} o \\\\ v \end{bmatrix}\) 这个基下，具有一个<strong>特定的块(block)结构</strong>：</p>
$$
P_k = \begin{bmatrix} P_{oo} & P_{ov} \\\\ P_{vo} & P_{vv} \end{bmatrix}
$$<ul>
<li>\(P_{oo}\) 是 \(m \times m\) 矩阵，代表“油-油”项。</li>
<li>\(P_{vv}\) 是 \(v \times v\) 矩阵，代表“醋-醋”项。</li>
<li>\(P_{ov}\) 和 \(P_{vo}\) 是 \(m \times v\) 和 \(v \times m\) 矩阵，代表“油-醋”混合项 (且 \(P_{vo} = P_{ov}^T\))。</li>
</ul>
<p><strong>UOV的核心秘密就是：\(P_{oo} = 0_{m \times m}\) ( \(m \times m\) 的零矩阵)。</strong></p>
<p>同时，线性部分的向量 \(L_k\) 也可以被分块： \(L_k = \begin{bmatrix} L_o \\\\ L_v \end{bmatrix}\)。</p>
<hr>
<h3 id="签名者的线性系统变换演示">签名者的线性系统变换演示</h3>
<p>签名者的第 \(k\) 个方程 \(F_k(x) = z_k\) 写作：</p>
$$
\begin{bmatrix} o^T & v^T \end{bmatrix} \begin{bmatrix} 0 & P_{ov} \\\\ P_{vo} & P_{vv} \end{bmatrix} \begin{bmatrix} o \\\\ v \end{bmatrix} + \begin{bmatrix} L_o^T & L_v^T \end{bmatrix} \begin{bmatrix} o \\\\ v \end{bmatrix} + C_k = z_k
$$<p>第 1 步：固定“醋” \(v = \bar{v}\)</p>
<p>签名者随机选择一个常数向量 \(\bar{v}\) 并代入。\(o\) 成为唯一的变量。</p>
$$
\begin{bmatrix} o^T & \bar{v}^T \end{bmatrix} \begin{bmatrix} 0 & P_{ov} \\\\ P_{vo} & P_{vv} \end{bmatrix} \begin{bmatrix} o \\\\ \bar{v} \end{bmatrix} + \begin{bmatrix} L_o^T & L_v^T \end{bmatrix} \begin{bmatrix} o \\\\ \bar{v} \end{bmatrix} + C_k = z_k
$$<p><strong>第 2 步：展开矩阵乘法 (二次项部分)</strong></p>
$$
(o^T \cdot 0 \cdot o) + (o^T P_{ov} \bar{v}) + (\bar{v}^T P_{vo} o) + (\bar{v}^T P_{vv} \bar{v})
$$<p><strong>第 3 步：化简</strong></p>
<ul>
<li>
<p>\(o^T \cdot 0 \cdot o = 0\)</p>
<p>这就是“魔法”发生的地方。 \(o\) 的所有二次项 \(o_i o_j\) 全部消失了，因为它们对应的系数矩阵是 \(0\)。</p>
</li>
<li>
<p>\((o^T P_{ov} \bar{v}) + (\bar{v}^T P_{vo} o)\)</p>
<p>因为 \(P_{vo} = P_{ov}^T\)，这两项是相等的（它们是标量，互为转置）。</p>
<p>这部分等于 \(2 (\bar{v}^T P_{vo}) o\)。这是一个 \(o\) 的线性项。</p>
</li>
<li>
<p>\((\bar{v}^T P_{vv} \bar{v})\)</p>
<p>\(\bar{v}\) 是常数，\(P_{vv}\) 是常数矩阵。这是一个常数。</p>
</li>
</ul>
<p><strong>第 4 步：展开线性项部分</strong>
</p>
$$
L_o^T o + L_v^T \bar{v}
$$<ul>
<li>\(L_o^T o\) 是 \(o\) 的<strong>线性项</strong>。</li>
<li>\(L_v^T \bar{v}\) 是一个<strong>常数</strong>。</li>
</ul>
<p>第 5 步：重组方程</p>
<p>我们将所有 \(o\) 的项（都是线性的）留在左边，所有常数项移到右边：</p>
$$
\underbrace{[ 2 (\bar{v}^T P_{vo}) + L_o^T ]}_{\text{一个 } 1 \times m \text{ 的常数行向量}} \cdot o = \underbrace{z_k - (\bar{v}^T P_{vv} \bar{v}) - (L_v^T \bar{v}) - C_k}_{\text{一个常数}}
$$<p>第 6 步：最终的线性系统</p>
<p>我们把 \(m\) 个这样的方程（\(k=1\) 到 \(m\)）堆叠起来。</p>
<ul>
<li>左侧的 \(m\) 个 (\(1 \times m\)) 行向量组成了一个 \(m \times m\) 的<strong>常数系数矩阵 \(M'\)</strong>。</li>
<li>右侧的 \(m\) 个常数组成了一个 \(m \times 1\) 的<strong>常数向量 \(R\)</strong>。</li>
</ul>
<p>签名者得到了一个易于求解的 \(m \times m\) 线性系统：</p>
$$
M' \cdot o = R
$$<hr>
<h3 id="攻击者的失败变换演示">攻击者的（失败）变换演示</h3>
<p>攻击者只知道公钥 \(G\) 和公开变量 \(y\)。</p>
<p>第 1 步：公钥 \(G\) 的矩阵是什么？</p>
<p>\(G(y) = F(A(y))\)。代入 \(x = Ay\)：</p>
$$
G_k(y) = (Ay)^T P_k (Ay) + L_k^T (Ay) + C_k
$$$$
G_k(y) = y^T (A^T P_k A) y + (L_k^T A) y + C_k
$$<p>公钥 \(G_k\) 的矩阵是 \(P'_k = A^T P_k A\)。</p>
<p>即使 \(P_k = \begin{bmatrix} 0 & P_{ov} \\\\ P_{vo} & P_{vv} \end{bmatrix}\) 是稀疏的，但 \(A\) 是一个稠密的 \(n \times n\) 矩阵。</p>
<p>\(P'_k = A^T P_k A\) 将是一个稠密的 \(n \times n\) 矩阵，它完全隐藏了 \(P_k\) 中那个 \(0\) 块的结构。</p>
<p>第 2 步：攻击者模仿“固定醋”</p>
<p>攻击者不知道 \(A\)，他只能猜测 \(y\) 的分块，比如 \(y = \begin{bmatrix} y_{oil} \\\\ y_{vin} \end{bmatrix}\)。</p>
<p>他将 \(P'_k\)（稠密矩阵）进行相应分块：</p>
$$
P'_k = \begin{bmatrix} P'_{oo} & P'_{ov} \\\\ P'_{vo} & P'_{vv} \end{bmatrix}
$$<p><strong>关键失败点：</strong> 由于 \(A\) 的“搅浑”作用，\(P'_k\) 是稠密的。<strong>\(P'_{oo}\) 几乎不可能是零矩阵</strong>。</p>
<p>第 3 步：代入 \(\bar{y}_{vin}\) 并展开</p>
<p>攻击者得到第 \(k\) 个方程（只看二次项）：</p>
$$
(y_{oil}^T P'_{oo} y_{oil}) + (y_{oil}^T P'_{ov} \bar{y}_{vin}) + (\bar{y}_{vin}^T P'_{vo} y_{oil}) + (\bar{y}_{vin}^T P'_{vv} \bar{y}_{vin})
$$$$ (y_{oil}^T P'{oo} y{oil}) + (y_{oil}^T P'{ov} \bar{y}{vin}) + (\bar{y}{vin}^T P'{vo} y_{oil}) + (\bar{y}{vin}^T P'{vv} \bar{y}_{vin}) $$<p>结论：</p>
<p>由于 \(P'_{oo} \neq 0 \) ，第一项 \(y_{oil}^T P'_{oo} y_{oil}\) 并不会消失。</p>
<p>这是一个关于 \(y_{oil}\) 的二次型。</p>
<p>因此，攻击者得到的系统仍然是一个<strong>多元二次 (MQ) 方程组</strong>，而不是线性方程组。他无法简化问题。</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2024-11-13</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/uov/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://galoishlee.github.io/uov/" data-title="Way-To-MPKC From UOV"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://galoishlee.github.io/uov/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://galoishlee.github.io/uov/" data-title="Way-To-MPKC From UOV"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://galoishlee.github.io/uov/" data-title="Way-To-MPKC From UOV"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://galoishlee.github.io/uov/" data-title="Way-To-MPKC From UOV"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/badagent0x00-intro/" class="prev" rel="prev" title="BadAgent0x00 Intro"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>BadAgent0x00 Intro</a>
            <a href="/vectorspace-matters/" class="next" rel="next" title="Vectorspace Matters">Vectorspace Matters<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app">Giscus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.152.2">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Halois</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"giscus":{"category":"Announcements","categoryId":"DIC_kwDOLrwAO84CekJn","darkTheme":"dark","emitMetadata":"0","inputPosition":"bottom","lang":"zh-CN","lazyLoading":false,"lightTheme":"light","mapping":"pathname","reactionsEnabled":"1","repo":"GaloisHLee/Giscus","repoId":"R_kgDOLrwAOw"}},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"},{"display":false,"left":"$","right":"$"}],"strict":false},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.zh-cn","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.d7121d72cd85153ec9d35a888cee3eb28c2700ca763f649a538f6c772d750021.js" integrity="sha256-1xIdcs2FFT7J01qIjO4+sownAMp2P2SaU49sdy11ACE="></script></body>
</html>
